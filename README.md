# Rococo - –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –∫–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–µ—Ä–æ–≤ –∏—Å–∫—É—Å—Å—Ç–≤–∞

<img src="rococo.png" width="800" alt="–õ–æ–≥–æ—Ç–∏–ø –ø—Ä–æ–µ–∫—Ç–∞ Rococo">

## üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

**Rococo** - —ç—Ç–æ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –∫–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–π –∏—Å–∫—É—Å—Å—Ç–≤–∞, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—â–∞—è:

- üé® –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥ —Ö—É–¥–æ–∂–Ω–∏–∫–æ–≤, –º—É–∑–µ–µ–≤ –∏ –∫–∞—Ä—Ç–∏–Ω
- üîê –ë–µ–∑–æ–ø–∞—Å–Ω—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é —á–µ—Ä–µ–∑ OAuth 2.0
- üìö –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–æ–∑–¥–∞–Ω–∏—è –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –∫–æ–ª–ª–µ–∫—Ü–∏–π
- üèó –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É

## üî• –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Spring Authorization Server
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ OAuth 2.0 –∏ JWT
- –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º
- CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è —Ö—É–¥–æ–∂–Ω–∏–∫–æ–≤, –º—É–∑–µ–µ–≤ –∏ –∫–∞—Ä—Ç–∏–Ω
- –ì–∏–±–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø–æ–∏—Å–∫–∞ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª
- –õ–∏—á–Ω—ã–µ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–π
- –ò—Å—Ç–æ—Ä–∏—è –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤
- –ò–∑–±—Ä–∞–Ω–Ω—ã–µ —Ä–∞–±–æ—Ç—ã

## ‚öôÔ∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
| –ö–∞—Ç–µ–≥–æ—Ä–∏—è       | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏                     |
|-----------------|--------------------------------|
| –ë—ç–∫–µ–Ω–¥          | Java 21, Spring Boot 3.2, gRPC |
| –ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö     | PostgreSQL 15                  |
| –ë—Ä–æ–∫–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π| Apache Kafka 7.3.2             |
| –§—Ä–æ–Ω—Ç–µ–Ω–¥        | Svelte, Thymeleaf              |
| –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞  | Docker, Selenoid, Allure       |

**–°—Ö–µ–º–∞ –ø—Ä–æ–µ–∫—Ç–∞ Rococo**

<img src="rococo-diagram.png" width="600">

# –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –ø—Ä–µ–¥—É—Å–ª–æ–≤–∏—è –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø—Ä–æ–µ–∫—Ç–æ–º Rococo

#### 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å docker (–ï—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)

–ú—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å docker –¥–ª—è –ë–î (Postgres), –∫—Ä–æ–º–µ —Ç–æ–≥–æ, –±—É–¥–µ–º –∑–∞–ø—É—Å–∫–∞—Ç—å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã –≤ –µ–¥–∏–Ω–æ–º docker network –ø—Ä–∏
–ø–æ–º–æ—â–∏ docker-compose

[–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞ Windows](https://docs.docker.com/desktop/install/windows-install/)

[–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞ Mac](https://docs.docker.com/desktop/install/mac-install/) (–î–ª—è ARM –∏ Intel —Ä–∞–∑–Ω—ã–µ –ø–∞–∫–µ—Ç—ã)

[–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞ Linux](https://docs.docker.com/desktop/install/linux-install/)

–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏ –∑–∞–ø—É—Å–∫–∞ docker daemon –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É–±–µ–¥–∏—Ç—å—Å—è –≤ —Ä–∞–±–æ—Ç–µ –∫–æ–º–∞–Ω–¥ docker, –Ω–∞–ø—Ä–∏–º–µ—Ä `docker -v`:

```posh
User-MacBook-Pro ~ % docker -v
Docker version 20.10.14, build a224086
```

#### 2. –°–ø—É–ª–ª–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä postgres:15.1, zookeeper –∏ kafka –≤–µ—Ä—Å–∏–∏ 7.3.2

```posh
docker pull postgres:15.1
docker pull confluentinc/cp-zookeeper:7.3.2
docker pull confluentinc/cp-kafka:7.3.2
```

–ü–æ—Å–ª–µ `pull` –≤—ã —É–≤–∏–¥–∏—Ç–µ —Å–ø—É–ª–µ–Ω–Ω—ã–π image –∫–æ–º–∞–Ω–¥–æ–π `docker images`

```posh
User-MacBook-Pro ~ % docker images            
REPOSITORY                 TAG              IMAGE ID       CREATED         SIZE
postgres                   15.1             9f3ec01f884d   10 days ago     379MB
confluentinc/cp-kafka      7.3.2            db97697f6e28   12 months ago   457MB
confluentinc/cp-zookeeper  7.3.2            6fe5551964f5   7 years ago     451MB

```

#### 3. –°–æ–∑–¥–∞—Ç—å volume –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ –ë–î –≤ docker –Ω–∞ –≤–∞—à–µ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ

```posh
docker volume create pgdata
```

#### 4. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ë–î, zookeeper –∏ kafka 3-–º—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–º–∏ –∫–æ–º–∞–Ω–¥–∞–º–∏:

–ó–∞–ø—É—Å—Ç–∏–≤ —Å–∫—Ä–∏–ø—Ç (–î–ª—è Windows –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å bash terminal: gitbash, cygwin –∏–ª–∏ wsl)

```posh
User-MacBook-Pro  rococo % bash localenv.sh
```

–ò–ª–∏ –≤—ã–ø–æ–ª–Ω–∏–≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –∫–æ–º–∞–Ω–¥—ã, –¥–ª—è *nix:

```posh
docker run --name rococo-all -p 5432:5432 -e POSTGRES_PASSWORD=secret \
  -e CREATE_DATABASES=rococo-auth,rococo-userdata,rococo-museum,rococo-artist,rococo-painting \
  -v pgdata:/var/lib/postgresql/data \
  -v ./postgres/init-database.sh:/docker-entrypoint-initdb.d/init-database.sh \
  -d postgres:15.1 --max_prepared_transactions=100
  
docker run --name=zookeeper -e ZOOKEEPER_CLIENT_PORT=2181 -p 2181:2181 -d confluentinc/cp-zookeeper:7.3.2

docker run --name=kafka -e KAFKA_BROKER_ID=1 \
-e KAFKA_ZOOKEEPER_CONNECT=$(docker inspect zookeeper --format='{{ .NetworkSettings.IPAddress }}'):2181 \
-e KAFKA_ADVERTISED_LISTENERS=PLAINTEXT://localhost:9092 \
-e KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR=1 \
-e KAFKA_TRANSACTION_STATE_LOG_MIN_ISR=1 \
-e KAFKA_TRANSACTION_STATE_LOG_REPLICATION_FACTOR=1 \
-p 9092:9092 -d confluentinc/cp-kafka:7.3.2
```

–î–ª—è Windows (–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å bash terminal: gitbash, cygwin –∏–ª–∏ wsl):

```posh
docker run --name rococo-all -p 5432:5432 -e POSTGRES_PASSWORD=secret \
  -e CREATE_DATABASES=rococo-auth,rococo-userdata,rococo-museum,rococo-artist,rococo-painting \
  -v pgdata:/var/lib/postgresql/data \
  -v ./postgres/init-database.sh:/docker-entrypoint-initdb.d/init-database.sh \
  -d postgres:15.1 --max_prepared_transactions=100
  
docker run --name=zookeeper -e ZOOKEEPER_CLIENT_PORT=2181 -p 2181:2181 -d confluentinc/cp-zookeeper:7.3.2

docker run --name=kafka -e KAFKA_BROKER_ID=1 \
-e KAFKA_ZOOKEEPER_CONNECT=$(docker inspect zookeeper --format='{{ .NetworkSettings.IPAddress }}'):2181 \
-e KAFKA_ADVERTISED_LISTENERS=PLAINTEXT://localhost:9092 \
-e KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR=1 \
-e KAFKA_TRANSACTION_STATE_LOG_MIN_ISR=1 \
-e KAFKA_TRANSACTION_STATE_LOG_REPLICATION_FACTOR=1 \
-p 9092:9092 -d confluentinc/cp-kafka:7.3.2
```

[–ü—Ä–æ IP zookeeper](https://github.com/confluentinc/cp-docker-images/issues/801#issuecomment-692085103)

–ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ Windows –∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å –ë–î –Ω–µ —Å—Ç–∞—Ä—Ç—É–µ—Ç —Å –æ—à–∏–±–∫–æ–π –≤ –ª–æ–≥–µ:

```
server started
/usr/local/bin/docker-entrypoint.sh: running /docker-entrypoint-initdb.d/init-database.sh
/usr/local/bin/docker-entrypoint.sh: /docker-entrypoint-initdb.d/init-database.sh: /bin/bash^M: bad interpreter: No such file or directory
```

–¢–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–º–∞–Ω–¥—ã –≤ –∫–∞—Ç–∞–ª–æ–≥–µ /postgres :

```
sed -i -e 's/\r$//' init-database.sh
chmod +x init-database.sh
```

#### 5. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Java –≤–µ—Ä—Å–∏–∏ 21. –≠—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ, —Ç.–∫. –ø—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–∏–Ω—Ç–∞–∫—Å–∏—Å Java 21

–í–µ—Ä—Å–∏—é —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–π Java –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–º–∞–Ω–¥–æ–π `java -version`

```posh
User-MacBook-Pro ~ % java -version
openjdk version "21.0.1" 2023-10-17 LTS
OpenJDK Runtime Environment Temurin-21.0.1+12 (build 21.0.1+12-LTS)
OpenJDK 64-Bit Server VM Temurin-21.0.1+12 (build 21.0.1+12-LTS, mixed mode)
```

–ï—Å–ª–∏ —É –≤–∞—Å –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–µ—Ä—Å–∏–π Java –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ - —Ç–æ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–∞ –∏–∑ –Ω–∏—Ö –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å 21
–ï—Å–ª–∏ java –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –≤–æ–≤—Å–µ, —Ç–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É—é —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å OpenJDK (–Ω–∞–ø—Ä–∏–º–µ—Ä,
–∏–∑ https://adoptium.net/en-GB/temurin/releases/)

#### 6. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∞–∫–µ—Ç—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è —Å–±–æ—Ä–∫–∏ front-end npm

[–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è](https://docs.npmjs.com/downloading-and-installing-node-js-and-npm).
–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è Node.js - 22.6.0

# –ó–∞–ø—É—Å–∫ Rococo –ª–æ–∫–∞–ª—å–Ω–æ–µ –≤ IDE:

#### 1. –ó–∞–ø—É—Å—Ç–∏—Ç—å REST —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥
```posh
User-MacBook-Pro rococo % cd rococo-client
```

#### 2. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –≤ —Ä–µ–∂–∏–º–µ preview (—Å–Ω–∞—á–∞–ª–∞ –æ–±–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏)

```posh
User-MacBook-Pro rococo-client % npm i
User-MacBook-Pro rococo-client % npm run dev
```

#### 3. –ü—Ä–æ–ø–∏—Å–∞—Ç—å run –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ rococo-* - Active profiles local

–î–ª—è —ç—Ç–æ–≥–æ –∑–∞–π—Ç–∏ –≤ –º–µ–Ω—é Run -> Edit Configurations -> –≤—ã–±—Ä–∞—Ç—å main –∫–ª–∞—Å—Å -> —É–∫–∞–∑–∞—Ç—å Active profiles: local
[–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è](https://stackoverflow.com/questions/39738901/how-do-i-activate-a-spring-boot-profile-when-running-from-intellij).

#### 4 –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å Rococo-auth c –ø–æ–º–æ—â—å—é gradle –∏–ª–∏ –∫–æ–º–∞–Ω–¥–æ–π Run –≤ IDE:

- –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å auth

```posh
User-MacBook-Pro rococo % cd rococo-auth
User-MacBook-Pro rococo-auth % gradle bootRun --args='--spring.profiles.active=local'
```

–ò–ª–∏ –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–π–¥—è –∫ main-–∫–ª–∞—Å—Å—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è RococoAuthApplication –≤—ã–±—Ä–∞—Ç—å run –≤ IDEA (–ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ —É–¥–æ—Å—Ç–æ–≤–µ—Ä–∏—Ç—å—Å—è —á—Ç–æ
–≤—ã–ø–æ–ª–Ω–µ–Ω –ø—Ä–µ–¥—ã–¥—É—â–∏–π –ø—É–Ω–∫—Ç)

#### 5  –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤ –ª—é–±–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥—Ä—É–≥–∏–µ —Å–µ—Ä–≤–∏—Å—ã: rococo-gateway, rococo-artist, rococo-painting, rococo-museum, rococo-userdata

–§—Ä–æ–Ω—Ç–µ–Ω–¥ Rococo –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ª–æ–∫–∞–ª—å–Ω–æ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –¥–ª—è –≤–∞—Å –ø–æ –∞–¥—Ä–µ—Å—É http://127.0.0.1:3000/,
OpenAPI (Swagger) —Å–µ—Ä–≤–∏—Å–∞ rococo-gateway –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: http://127.0.0.1:8090/swagger-ui/index.html
# –ó–∞–ø—É—Å–∫ Rococo –≤ –¥–æ–∫–µ—Ä–µ:

#### 1. –°–æ–∑–¥–∞—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω—É—é —É—á–µ—Ç–Ω—É—é –∑–∞–ø–∏—Å—å –Ω–∞ https://hub.docker.com/ (–µ—Å–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç)

#### 2. –°–æ–∑–¥–∞—Ç—å –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —Å–≤–æ–µ–π —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏ access_token

[–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è](https://docs.docker.com/docker-hub/access-tokens/).

#### 3. –í—ã–ø–æ–ª–Ω–∏—Ç—å docker login —Å —Å–æ–∑–¥–∞–Ω–Ω—ã–º access_token (–≤ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ —ç—Ç–æ –æ–ø–∏—Å–∞–Ω–æ)

#### 4. –ü—Ä–æ–ø–∏—Å–∞—Ç—å –≤ etc/hosts —ç–ª–∏–∞—Å –¥–ª—è Docker-–∏–º–µ–Ω–∏

- frontend:  127.0.0.1 frontend.rococo.dc
- auth:      127.0.0.1 auth.rococo.dc
- gateway:   127.0.0.1 gateway.rococo.dc
- allure:    127.0.0.1 allure

```posh
User-MacBook-Pro rococo % vi /etc/hosts
```

```posh
##
# Host Database
#
# localhost is used to configure the loopback interface
# when the system is booting.  Do not change this entry.
##
127.0.0.1       localhost
127.0.0.1       frontend.rococo.dc
127.0.0.1       auth.rococo.dc
127.0.0.1       gateway.rococo.dc
127.0.0.1       allure
```

#### 5. –ü–µ—Ä–µ–π—Ç–∏ –≤ –∫–æ—Ä–Ω–µ–≤–æ–π –∫–∞—Ç–∞–ª–æ–≥ –ø—Ä–æ–µ–∫—Ç–∞

```posh
User-MacBook-Pro rococo % cd rococo
```

#### 6. –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã:
```posh
User-MacBook-Pro  rococo % bash docker-compose-dev.sh
```

–¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è `docker-compose-dev.sh` **—É–¥–∞–ª–∏—Ç –≤—Å–µ –∑–∞–ø—É—â–µ–Ω–Ω—ã–µ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –≤ —Å–∏—Å—Ç–µ–º–µ**, –ø–æ—ç—Ç–æ–º—É –µ—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å
—Å–æ–∑–¥–∞–Ω–Ω—ã–µ
–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –¥–ª—è –¥—Ä—É–≥–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ - –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Å—Ç—Ä–æ–∫—É ```posh docker rm $(docker ps -a -q)```, —á—Ç–æ–±—ã –≤–∫–ª—é—á–∏—Ç—å –≤ grep
—Ç–æ–ª—å–∫–æ —Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã, —á—Ç–æ –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –æ—Ç–Ω–æ—Å—è—Ç—Å—è –∫ rococo.

–§—Ä–æ–Ω—Ç–µ–Ω–¥ Rococo –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –≤ –¥–æ–∫–µ—Ä–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –¥–ª—è –≤–∞—Å –ø–æ –∞–¥—Ä–µ—Å—É http://frontend.rococo.dc,
OpenAPI (Swagger) —Å–µ—Ä–≤–∏—Å–∞ rococo-gateway –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: http://gateway.rococo.dc:8090/swagger-ui/index.html

–ï—Å–ª–∏ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ —Å–∫—Ä–∏–ø—Ç–∞ `docker-compose-dev.sh` –≤—ã –ø–æ–ª—É—á–∏–ª–∏ –æ—à–∏–±–∫—É:

```
* What went wrong:
Execution failed for task ':rococo-auth:jibDockerBuild'.
> com.google.cloud.tools.jib.plugins.common.BuildStepsExecutionException: 
Build to Docker daemon failed, perhaps you should make sure your credentials for 'registry-1.docker.io...
```

–¢–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤ `$USER/.docker/config.json` —Ñ–∞–π–ª–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∑–∞–ø–∏—Å—å `"credsStore": "desktop"`
–ü—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ —Ç–∞–∫–æ–≥–æ –∫–ª—é—á–∞ –≤ json, –µ–≥–æ –Ω–∞–¥–æ —É–¥–∞–ª–∏—Ç—å.
–ï—Å–ª–∏ —Ñ–∞–π–ª –ø—É—Å—Ç–æ–π, —Ç–æ –≤–æ–∑–º–æ–∂–Ω–æ –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω `docker login`. –ï—Å–ª–∏ –≤—ã–ø–æ–ª–Ω—è–ª—Å—è, —Ç–æ –Ω–∞–¥–æ —Å–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª —Ä—É–∫–∞–º–∏ –ø–æ –ø—É—Ç–∏
`$USER/.docker/config.json`
—Å —Å–æ–¥–µ—Ä–∂–∏–º—ã–º,

```
 {
        "auths": {
                "https://index.docker.io/v1/": {}
        },
        "currentContext": "desktop-linux"
}
```

–ï—Å–ª–∏ –≤—ã –Ω–µ –º–æ–∂–µ—Ç–µ –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –ë–î –≤ docker, —É–∫–∞–∑—ã–≤–∞—è –≤–µ—Ä–Ω—ã–µ login –∏ password, —Ç–æ –≤–æ–∑–º–æ–∂–Ω–æ —É –≤–∞—Å –ø–æ–¥–Ω—è—Ç–∞ –¥—Ä—É–≥–∞—è –±–∞–∑–∞ –Ω–∞
—Ç–æ–º –∂–µ –ø–æ—Ä—Ç—É 5432 .
–≠—Ç–æ –∏–∑–≤–µ—Å—Ç–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞, —á—Ç–æ Postgres –≤ docker –º–æ–∂–µ—Ç —Å—Ç–∞—Ä—Ç–∞–Ω—É—Ç—å –ø—Ä–∏ –∑–∞–Ω—è—Ç–æ–º –ø–æ—Ä—Ç—É 5432, –Ω–∞–¥–æ —É–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ —É –≤–∞—Å –Ω–µ
–ø–æ–¥–Ω—è—Ç –Ω–∏–∫–∞–∫–æ–π –¥—Ä—É–≥–æ–π Postgres –Ω–∞ —ç—Ç–æ–º –ø–æ—Ä—Ç—É.

–ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ Windows –∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å –ë–î –Ω–µ —Å—Ç–∞—Ä—Ç—É–µ—Ç —Å –æ—à–∏–±–∫–æ–π –≤ –ª–æ–≥–µ:

```
server started
/usr/local/bin/docker-entrypoint.sh: running /docker-entrypoint-initdb.d/init-database.sh
/usr/local/bin/docker-entrypoint.sh: /docker-entrypoint-initdb.d/init-database.sh: /bin/bash^M: bad interpreter: No such file or directory
```

–¢–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–º–∞–Ω–¥—ã –≤ –∫–∞—Ç–∞–ª–æ–≥–µ /postgres :

```
sed -i -e 's/\r$//' init-database.sh
chmod +x init-database.sh
```

# –°–æ–∑–¥–∞–Ω–∏–µ —Å–≤–æ–µ–≥–æ docker repository –¥–ª—è —Ñ–æ—Ä–∫–∞ Rococo –∏ —Å–±–æ—Ä–∫–∞ —Å–≤–æ–∏—Ö –¥–æ–∫–µ—Ä –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

#### 1. –í–æ–π—Ç–∏ –≤ —Å–≤–æ—é –£–ó –Ω–∞ https://hub.docker.com/ –∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ —Å–æ–∑–¥–∞—Ç—å –ø—É–±–ª–∏—á–Ω—ã–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏

- rococo-client
- rococo-gateway
- rococo-auth
- rococo-artist
- rococo-painting
- rococo-museum
- rococo-userdata

–î–æ–ø—É—Å—Ç–∏–º, —á—Ç–æ –≤–∞—à username –Ω–∞ https://hub.docker.com - *foobazz*

#### 2. –∑–∞–º–µ–Ω–∏—Ç—å –≤ —Ñ–∞–π–ª–µ docker.properties (–≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞) IMAGE_PREFIX=qaguru –Ω–∞ IMAGE_PREFIX=foobazz

- –≥–¥–µ foobazz - –≤–∞—à —é–∑–µ—Ä–Ω—ç–π–º –Ω–∞ https://hub.docker.com/

#### 3. –∑–∞–º–µ–Ω–∏—Ç—å –≤ —Ñ–∞–π–ª–µ build.gradle (–≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞) dockerHubName = "qaguru" –Ω–∞ dockerHubName = "foobazz"

- –≥–¥–µ foobazz - –≤–∞—à —é–∑–µ—Ä–Ω—ç–π–º –Ω–∞ https://hub.docker.com/

#### 4. –ü–µ—Ä–µ–π—Ç–∏ –≤ –∫–æ—Ä–Ω–µ–≤–æ–π –∫–∞—Ç–∞–ª–æ–≥ –ø—Ä–æ–µ–∫—Ç–∞

```posh
User-MacBook-Pro rococo % cd rococo
```

#### 5. –°–æ–±—Ä–∞—Ç—å –≤—Å–µ –∏–º–µ–¥–∂–∏, –∑–∞–ø—É—à–∏—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å Rococo –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π:
```posh
User-MacBook-Pro  rococo % bash docker-compose-dev.sh push
```

# –ó–∞–ø—É—Å–∫ e-2-e —Ç–µ—Å—Ç–æ–≤ –≤ Docker network –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ Rococo –≤ –¥–æ–∫–µ—Ä–µ:

#### 1. –ü–µ—Ä–µ–π—Ç–∏ –≤ –∫–æ—Ä–Ω–µ–≤–æ–π –∫–∞—Ç–∞–ª–æ–≥ –ø—Ä–æ–µ–∫—Ç–∞

```posh
User-MacBook-Pro rococo % cd rococo
```

#### 2. –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã –∏ —Ç–µ—Å—Ç—ã:
```posh
User-MacBook-Pro  rococo % bash docker-compose-e2e.sh
```

#### 3. Selenoid UI –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: http://localhost:9090/

#### 4. Allure –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: http://localhost:5050/allure-docker-service/projects/rococo/reports/latest/index.html

<img src="allure-1.png" width="600">
<img src="allure-2.png" width="600">
<img src="allure-3.png" width="600">